<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wave Beat Ultra</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,sans-serif;}
html{scroll-behavior:smooth;}
body{background:#0f0f0f;color:white;display:flex;height:100vh;overflow:hidden;transition:0.3s;}
body.light{background:#f4f4f4;color:#111;}

.sidebar{
width:230px;background:#181818;padding:20px;transition:0.3s;
}
body.light .sidebar{background:#ffffff;}

.logo{
display:flex;align-items:center;gap:10px;margin-bottom:20px;
}

.logo svg{
width:35px;height:35px;animation:pulse 2s infinite;
}

@keyframes pulse{
0%{transform:scale(1);}
50%{transform:scale(1.15);}
100%{transform:scale(1);}
}

.sidebar button{
width:100%;margin:8px 0;padding:10px;
border:none;border-radius:8px;
background:#222;color:white;cursor:pointer;
transition:0.3s;
}
body.light .sidebar button{background:#ddd;color:#111;}
.sidebar button:hover{background:#1db954;color:white;}

.main{
flex:1;padding:25px;overflow-y:auto;
}

.page{display:none;animation:fade 0.3s;}
.page.active{display:block;}

input{
width:100%;padding:10px;margin:8px 0;
border:none;border-radius:8px;
}

button.primary{
background:#1db954;color:white;
padding:10px;border:none;border-radius:8px;
cursor:pointer;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(140px,1fr));
gap:15px;margin-top:20px;
}

.card{
background:#181818;padding:10px;
border-radius:12px;text-align:center;
cursor:pointer;transition:0.3s;
}
body.light .card{background:#ffffff;}
.card:hover{transform:scale(1.05);}

.card img{
width:100%;border-radius:8px;margin-bottom:8px;
}

.playerBar{
position:fixed;bottom:0;left:0;width:100%;
background:#181818;padding:10px;
display:flex;flex-wrap:wrap;
align-items:center;justify-content:space-between;
}
body.light .playerBar{background:#ffffff;}

.playerBar img{width:50px;border-radius:6px;}

canvas{
width:100%;height:60px;
}

.menuBtn{display:none;background:#1db954;border:none;padding:8px;border-radius:6px;margin-bottom:15px;color:white;}

@media(max-width:768px){
body{flex-direction:column;}
.sidebar{position:absolute;left:-250px;top:0;height:100%;z-index:1000;}
.sidebar.active{left:0;}
.menuBtn{display:block;}
.playerBar{flex-direction:column;align-items:flex-start;}
}

@keyframes fade{from{opacity:0}to{opacity:1}}
</style>
</head>

<body>

<div class="sidebar" id="sidebar">

<div class="logo">
<svg viewBox="0 0 24 24" fill="#1db954">
<path d="M9 18V5l12-2v13"/>
</svg>
<h2>WaveBeat</h2>
</div>

<button onclick="showPage('home')">Home</button>
<button onclick="showPage('upload')">Upload</button>
<button onclick="showPage('library')">Library</button>
<button onclick="toggleTheme()">Toggle Theme</button>

</div>

<div class="main">

<button class="menuBtn" onclick="toggleMenu()">☰ Menu</button>

<div id="home" class="page active">
<h1>Wave Beat Ultra</h1>
<p>Premium Responsive Music Experience</p>
</div>

<div id="upload" class="page">
<h1>Upload Song</h1>
<input type="text" id="title" placeholder="Song Title">
<input type="file" id="audioFile" accept="audio/*">
<button class="primary" onclick="uploadSong()">Upload</button>
</div>

<div id="library" class="page">
<h1>Your Library</h1>
<div class="grid" id="songGrid"></div>
</div>

</div>

<div class="playerBar" id="playerBar" style="display:none;">
<div style="display:flex;align-items:center;gap:10px;">
<img id="playerCover">
<div id="playerTitle"></div>
</div>

<div>
<button onclick="prevSong()">⏮</button>
<button onclick="togglePlay()" id="playBtn">▶</button>
<button onclick="nextSong()">⏭</button>
</div>

<div style="width:100%;">
<canvas id="visualizer"></canvas>
<input type="range" id="progress">
</div>
</div>

<script>
let currentIndex=0;
let audio=new Audio();
let ctx, analyser, source, canvas;

function toggleMenu(){
document.getElementById("sidebar").classList.toggle("active");
}

function toggleTheme(){
document.body.classList.toggle("light");
}

function showPage(id){
document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
document.getElementById(id).classList.add('active');
if(window.innerWidth<768)toggleMenu();
if(id==="library")loadSongs();
}

function randomGradient(){
let colors=["#ff0080","#7928ca","#1db954","#ff8c00","#00c6ff"];
return colors[Math.floor(Math.random()*colors.length)];
}

function generateCover(text){
let canvas=document.createElement("canvas");
canvas.width=300;canvas.height=300;
let ctx=canvas.getContext("2d");
let grad=ctx.createLinearGradient(0,0,300,300);
grad.addColorStop(0,randomGradient());
grad.addColorStop(1,randomGradient());
ctx.fillStyle=grad;
ctx.fillRect(0,0,300,300);
ctx.fillStyle="white";
ctx.font="bold 24px Arial";
ctx.fillText(text,40,160);
return canvas.toDataURL();
}

function uploadSong(){
let title=document.getElementById("title").value;
let file=document.getElementById("audioFile").files[0];
if(!title||!file){alert("Fill all fields");return;}
let reader=new FileReader();
reader.onload=e=>{
let songs=JSON.parse(localStorage.getItem("songs"))||[];
songs.push({id:Date.now(),title,audio:e.target.result,cover:generateCover(title)});
localStorage.setItem("songs",JSON.stringify(songs));
alert("Uploaded!");
};
reader.readAsDataURL(file);
}

function loadSongs(){
let songs=JSON.parse(localStorage.getItem("songs"))||[];
let grid=document.getElementById("songGrid");
grid.innerHTML="";
songs.forEach((song,i)=>{
let card=document.createElement("div");
card.className="card";
card.innerHTML=`<img src="${song.cover}"><h4>${song.title}</h4>`;
card.onclick=()=>playSong(i);
grid.appendChild(card);
});
}

function setupVisualizer(){
canvas=document.getElementById("visualizer");
ctx=canvas.getContext("2d");
let audioCtx=new AudioContext();
analyser=audioCtx.createAnalyser();
source=audioCtx.createMediaElementSource(audio);
source.connect(analyser);
analyser.connect(audioCtx.destination);
analyser.fftSize=64;
draw();
}

function draw(){
requestAnimationFrame(draw);
let bufferLength=analyser.frequencyBinCount;
let dataArray=new Uint8Array(bufferLength);
analyser.getByteFrequencyData(dataArray);
ctx.clearRect(0,0,canvas.width,canvas.height);
let barWidth=(canvas.width/bufferLength);
for(let i=0;i<bufferLength;i++){
let barHeight=dataArray[i];
ctx.fillStyle="#1db954";
ctx.fillRect(i*barWidth,canvas.height-barHeight/2,barWidth-2,barHeight/2);
}
}

function playSong(index){
let songs=JSON.parse(localStorage.getItem("songs"))||[];
currentIndex=index;
audio.src=songs[index].audio;
audio.play();
document.getElementById("playerBar").style.display="flex";
document.getElementById("playerCover").src=songs[index].cover;
document.getElementById("playerTitle").innerText=songs[index].title;
if(!analyser)setupVisualizer();
}

function togglePlay(){
if(audio.paused){audio.play();playBtn.innerText="⏸";}
else{audio.pause();playBtn.innerText="▶";}
}

function prevSong(){if(currentIndex>0)playSong(currentIndex-1);}
function nextSong(){
let songs=JSON.parse(localStorage.getItem("songs"))||[];
if(currentIndex<songs.length-1)playSong(currentIndex+1);
}

audio.addEventListener("timeupdate",()=>{
progress.value=(audio.currentTime/audio.duration)*100||0;
});
progress.oninput=function(){
audio.currentTime=(progress.value/100)*audio.duration;
};
</script>

</body>
</html>
